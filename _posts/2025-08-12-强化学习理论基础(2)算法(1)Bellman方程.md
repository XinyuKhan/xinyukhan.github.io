# Bellman方程

$$
\begin{aligned}
Q_\pi(s_t, a_t) & = \mathbb{E}_{S_{t+1}, R_{t+1}}[R_{t+1} + \gamma Q_\pi(S_{t+1}, A_{t+1}) | S_t = s_t, A_t = a_t] \\
\end{aligned}
$$

## 证明

根据定义

$$
\begin{aligned}
Q_\pi(s_t, a_t) & = \mathbb{E}_{\mathcal{S}_{t+1:}, \mathcal{A}_{t+1:}}[U_t | S_t = s_t, A_t = a_t] \\
U_t &= R_t + \gamma \underbrace{\sum_{k=t+1}^{n} \gamma^{k-t-1} R_k}_{=U_{t+1}} \\
&= R_t + \gamma U_{t+1} \\
\end{aligned}
$$

代入可得到

$$
\begin{aligned}
Q_\pi(s_t, a_t) & = \mathbb{E}_{S_{t+1}, R_{t+1}}[R_{t+1} + \gamma U_{t+1} | S_t = s_t, A_t = a_t] \\
\end{aligned}
$$